<div class="news-section">
  <h2 class="section-title">
    <i class="bi bi-newspaper"></i> {{ 'NEWS.TITLE' | translate }}
  </h2>

  <!-- Admin Add/Edit Form -->
  <div *ngIf="isAdmin && showForm" class="news-form">
    <h4 class="form-title">
      {{ selectedNews.id ? ('NEWS.EDIT_NEWS' | translate) : ('NEWS.ADD_NEWS' | translate) }}
    </h4>

    <div class="form-grid">
      <input type="text" [(ngModel)]="selectedNews.title" placeholder="{{ 'NEWS.PLACEHOLDER_TITLE' | translate }}" />
      <input type="text" [(ngModel)]="selectedNews.category" placeholder="{{ 'NEWS.PLACEHOLDER_CATEGORY' | translate }}" />
      <textarea [(ngModel)]="selectedNews.content" rows="3" placeholder="{{ 'NEWS.PLACEHOLDER_DESC' | translate }}"></textarea>
      <input type="text" [(ngModel)]="selectedNews.url" placeholder="{{ 'NEWS.PLACEHOLDER_URL' | translate }}" />
      <input type="date" [(ngModel)]="selectedNews.date" />
      <input type="file" (change)="onFileSelected($event)" />
    </div>

    <div class="form-buttons">
      <button class="btn-save" (click)="saveNews()">üíæ {{ 'NEWS.SAVE' | translate }}</button>
      <button class="btn-cancel" (click)="cancel()">‚úñ {{ 'NEWS.CANCEL' | translate }}</button>
    </div>
  </div>

  <!-- Add Button -->
  <div class="toolbar" *ngIf="isAdmin && !showForm">
    <button class="btn-add" (click)="toggleForm()">‚ûï {{ 'NEWS.ADD_NEWS' | translate }}</button>
  </div>

  <!-- News Grid -->
  <div class="news-grid">
    <div class="news-card" *ngFor="let item of paginatedNews">
      <div class="news-image" *ngIf="item.image">
        <img [src]="item.image" alt="{{item.title}}" />
      </div>

      <div class="embed" *ngIf="item.url">
        <iframe
          [src]="getEmbedUrl(item.url) | safeUrl"
          width="100%"
          height="250"
          frameborder="0"
          allowfullscreen>
        </iframe>
      </div>

      <div class="news-content">
        <h3 class="news-title">{{ item.title }}</h3>
        <span class="category">{{ item.category }}</span>
        <p class="news-text">{{ item.content | slice:0:100 }}...</p>
        <span class="date">{{ item.date }}</span>

        <!-- Public view button -->
        <button class="btn-view" (click)="openPost(item)">üëÅÔ∏è View Post</button>

        <div *ngIf="isAdmin" class="admin-actions">
          <button class="btn-edit" (click)="edit(item)">‚úè {{ 'NEWS.EDIT' | translate }}</button>
          <button class="btn-delete" (click)="delete(item.id, item.image)">üóë {{ 'NEWS.DELETE' | translate }}</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination controls -->
  <div class="pagination-controls" *ngIf="totalPages > 1">
    <button *ngIf="isAdmin" class="btn-nav" [disabled]="currentPage === 1" (click)="prevPage()">‚¨Ö Previous</button>
    <span>Page {{ currentPage }} of {{ totalPages }}</span>
    <button *ngIf="isAdmin" class="btn-nav" [disabled]="currentPage === totalPages" (click)="nextPage()">Next ‚û°</button>
  </div>

  <!-- Zoom Modal -->
  <div class="post-modal" *ngIf="selectedViewPost" (click)="closePost()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <span class="close-btn" (click)="closePost()">‚úñ</span>

      <div class="modal-image" *ngIf="selectedViewPost.image">
        <img [src]="selectedViewPost.image" alt="{{selectedViewPost.title}}" />
      </div>

      <h2>{{ selectedViewPost.title }}</h2>
      <span class="category">{{ selectedViewPost.category }}</span>
      <p>{{ selectedViewPost.content }}</p>
      <span class="date">{{ selectedViewPost.date }}</span>

      <div class="modal-embed" *ngIf="selectedViewPost.url">
        <iframe
          [src]="getEmbedUrl(selectedViewPost.url) | safeUrl"
          width="100%"
          height="300"
          frameborder="0"
          allowfullscreen>
        </iframe>
      </div>
    </div>
  </div>
</div>
